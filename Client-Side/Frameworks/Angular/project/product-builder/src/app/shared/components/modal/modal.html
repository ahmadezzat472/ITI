<el-dialog>
  <dialog
    [id]="modalId"
    [attr.aria-labelledby]="modalId + '-title'"
    class="fixed inset-0 size-auto max-h-none max-w-none overflow-y-auto bg-transparent backdrop:bg-transparent"
  >
    <el-dialog-backdrop
      class="fixed inset-0 bg-neutral-950/60 backdrop-blur-sm transition-opacity data-closed:opacity-0 data-enter:duration-300 data-enter:ease-out data-leave:duration-200 data-leave:ease-in"
    ></el-dialog-backdrop>

    <div
      tabindex="0"
      class="flex min-h-full items-end justify-center p-4 text-center focus:outline-none sm:items-center sm:p-0"
    >
      <el-dialog-panel
        [class]="
          'relative w-full transform overflow-hidden rounded-2xl bg-surface-secondary text-left shadow-strong outline -outline-offset-1 outline-border-primary transition-all data-closed:translate-y-4 data-closed:opacity-0 data-closed:scale-95 data-enter:duration-300 data-enter:ease-out data-leave:duration-200 data-leave:ease-in sm:my-8 ' +
          sizeClasses
        "
      >
        <!-- Header -->
        @if (showHeader) {
          <div class="border-b border-border-secondary bg-surface-primary px-6 pt-6 pb-5">
            <div class="flex items-start gap-4">
              <!-- Icon (optional) -->
              @if (icon) {
                <div
                  [class]="
                    'flex size-12 shrink-0 items-center justify-center rounded-xl ring-1 ' +
                    iconClasses
                  "
                >
                  <!-- Warning Icon -->
                  @if (icon === 'warning' || icon === 'danger') {
                    <svg
                      viewBox="0 0 24 24"
                      fill="none"
                      stroke="currentColor"
                      stroke-width="2"
                      class="size-6"
                    >
                      <path
                        d="M12 9v3.75m-9.303 3.376c-.866 1.5.217 3.374 1.948 3.374h14.71c1.73 0 2.813-1.874 1.948-3.374L13.949 3.378c-.866-1.5-3.032-1.5-3.898 0L2.697 16.126ZM12 15.75h.007v.008H12v-.008Z"
                        stroke-linecap="round"
                        stroke-linejoin="round"
                      />
                    </svg>
                  }

                  <!-- Success Icon -->
                  @if (icon === 'success') {
                    <svg
                      viewBox="0 0 24 24"
                      fill="none"
                      stroke="currentColor"
                      stroke-width="2"
                      class="size-6"
                    >
                      <path
                        d="M9 12.75L11.25 15 15 9.75M21 12a9 9 0 11-18 0 9 9 0 0118 0z"
                        stroke-linecap="round"
                        stroke-linejoin="round"
                      />
                    </svg>
                  }

                  <!-- Info Icon -->
                  @if (icon === 'info') {
                    <svg
                      viewBox="0 0 24 24"
                      fill="none"
                      stroke="currentColor"
                      stroke-width="2"
                      class="size-6"
                    >
                      <path
                        d="M11.25 11.25l.041-.02a.75.75 0 011.063.852l-.708 2.836a.75.75 0 001.063.853l.041-.021M21 12a9 9 0 11-18 0 9 9 0 0118 0zm-9-3.75h.008v.008H12V8.25z"
                        stroke-linecap="round"
                        stroke-linejoin="round"
                      />
                    </svg>
                  }
                </div>
              }
              <!-- Title and Subtitle -->
              <div class="flex-1 min-w-0">
                <h3 [id]="modalId + '-title'" class="text-lg font-semibold text-white leading-6">
                  {{ title }}
                </h3>
                @if (subtitle) {
                  <p class="mt-2 text-sm text-neutral-400 leading-relaxed">
                    {{ subtitle }}
                  </p>
                }
              </div>

              <!-- Close Button -->
              <button
                type="button"
                command="close"
                [attr.commandfor]="modalId"
                (click)="onClose()"
                class="shrink-0 rounded-lg p-1.5 text-neutral-400 transition-colors hover:bg-surface-hover hover:text-neutral-200 focus:outline-none focus:ring-2 focus:ring-primary-500"
                aria-label="Close dialog"
              >
                <svg
                  viewBox="0 0 24 24"
                  fill="none"
                  stroke="currentColor"
                  stroke-width="2"
                  class="size-5"
                >
                  <path d="M6 18L18 6M6 6l12 12" stroke-linecap="round" stroke-linejoin="round" />
                </svg>
              </button>
            </div>
          </div>
        }

        <!-- Body Content (projected) -->
        <div class="max-h-[70vh] overflow-y-auto scrollbar-custom px-6 py-6">
          <ng-content></ng-content>
        </div>

        <!-- Footer -->
        @if (showFooter) {
          <div class="border-t border-border-secondary bg-surface-tertiary/50 px-6 py-4">
            <div class="flex flex-col-reverse gap-3 sm:flex-row sm:justify-end">
              <button
                type="button"
                command="close"
                [attr.commandfor]="modalId"
                class="btn-outline"
                [disabled]="isLoading"
                (click)="onCancel()"
              >
                Cancel
              </button>
              <button
                type="button"
                [class]="confirmButtonClass"
                [disabled]="isLoading || ConfirmButtonDisabled"
                (click)="onConfirm()"
              >
                @if (isLoading) {
                  <svg class="mr-2 size-4 animate-spin" fill="none" viewBox="0 0 24 24">
                    <circle
                      class="opacity-25"
                      cx="12"
                      cy="12"
                      r="10"
                      stroke="currentColor"
                      stroke-width="4"
                    ></circle>
                    <path
                      class="opacity-75"
                      fill="currentColor"
                      d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"
                    ></path>
                  </svg>
                }
                @if (!isLoading && type !== 'danger') {
                  <svg class="mr-2 size-4" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                    <path
                      stroke-linecap="round"
                      stroke-linejoin="round"
                      stroke-width="2"
                      d="M5 13l4 4L19 7"
                    />
                  </svg>
                }
                {{ isLoading ? 'Processing...' : confirmText }}
              </button>
            </div>
          </div>
        }
      </el-dialog-panel>
    </div>
  </dialog>
</el-dialog>
