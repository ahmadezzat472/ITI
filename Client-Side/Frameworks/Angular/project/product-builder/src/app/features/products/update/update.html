<form [formGroup]="productForm" (ngSubmit)="onSubmit()" class="space-y-6">
  <!-- Product Name -->
  <div>
    <label class="mb-2 block text-sm font-medium text-neutral-300">
      Product Name <span class="text-danger-400">*</span>
    </label>
    <input
      type="text"
      formControlName="name"
      placeholder="Enter product name"
      class="input"
      [class.input-error]="productForm.get('name')?.touched && productForm.get('name')?.invalid"
    />
    @if (productForm.get('name')?.touched && productForm.get('name')?.invalid) {
      <p class="mt-1 text-sm text-danger-400">
        {{ getErrorMessage('name') }}
      </p>
    }
  </div>

  <!-- Category -->
  <div>
    <label class="mb-2 block text-sm font-medium text-neutral-300">
      Category <span class="text-danger-400">*</span>
    </label>
    <select
      formControlName="categoryId"
      class="input"
      [class.input-error]="
        productForm.get('categoryId')?.touched && productForm.get('categoryId')?.invalid
      "
    >
      <option [value]="null">Select category</option>
      @for (category of categories(); track category.id) {
        <option [value]="category.id">{{ category.name }}</option>
      }
    </select>
    @if (productForm.get('categoryId')?.touched && productForm.get('categoryId')?.invalid) {
      <p class="mt-1 text-sm text-danger-400">
        {{ getErrorMessage('categoryId') }}
      </p>
    }
  </div>

  <!-- Price and Stock -->
  <div class="grid grid-cols-1 gap-4 sm:grid-cols-2">
    <!-- Price -->
    <div>
      <label class="mb-2 block text-sm font-medium text-neutral-300">
        Price <span class="text-danger-400">*</span>
      </label>
      <div class="relative">
        <span class="absolute left-3 top-1/2 -translate-y-1/2 text-neutral-400">$</span>
        <input
          type="number"
          formControlName="price"
          placeholder="0.00"
          class="input pl-8"
          step="0.01"
          min="0"
          [class.input-error]="
            productForm.get('price')?.touched && productForm.get('price')?.invalid
          "
        />
      </div>
      @if (productForm.get('price')?.touched && productForm.get('price')?.invalid) {
        <p class="mt-1 text-sm text-danger-400">
          {{ getErrorMessage('price') }}
        </p>
      }
    </div>

    <!-- Stock -->
    <div>
      <label class="mb-2 block text-sm font-medium text-neutral-300">
        Stock Quantity <span class="text-danger-400">*</span>
      </label>
      <input
        type="number"
        formControlName="stock"
        placeholder="0"
        class="input"
        min="0"
        [class.input-error]="productForm.get('stock')?.touched && productForm.get('stock')?.invalid"
      />
      @if (productForm.get('stock')?.touched && productForm.get('stock')?.invalid) {
        <p class="mt-1 text-sm text-danger-400">
          {{ getErrorMessage('stock') }}
        </p>
      }
    </div>
  </div>

  <!-- Description -->
  <div>
    <label class="mb-2 block text-sm font-medium text-neutral-300"> Description </label>
    <textarea
      formControlName="description"
      placeholder="Enter product description"
      rows="4"
      class="input resize-none"
      [class.input-error]="
        productForm.get('description')?.touched && productForm.get('description')?.invalid
      "
    ></textarea>
    @if (productForm.get('description')?.touched && productForm.get('description')?.invalid) {
      <p class="mt-1 text-sm text-danger-400">
        {{ getErrorMessage('description') }}
      </p>
    }
  </div>

  <!-- Image URL -->
  <div>
    <label class="mb-2 block text-sm font-medium text-neutral-300"> Image URL </label>
    <input
      type="text"
      formControlName="img"
      placeholder="https://example.com/image.jpg"
      class="input"
      [class.input-error]="productForm.get('img')?.touched && productForm.get('img')?.invalid"
    />
    @if (productForm.get('img')?.touched && productForm.get('img')?.invalid) {
      <p class="mt-1 text-sm text-danger-400">
        {{ getErrorMessage('img') }}
      </p>
    }
    @if (productForm.get('img')?.valid && productForm.get('img')?.value) {
      <div class="mt-2">
        <p class="mb-1 text-xs text-success-400">Preview:</p>
        <img
          [src]="productForm.get('img')?.value"
          alt="Product preview"
          class="h-20 w-20 rounded-lg object-cover ring-1 ring-border-primary"
          (error)="productForm.get('img')?.setErrors({ pattern: true })"
        />
      </div>
    }
  </div>

  <!-- Form Status (Optional - for debugging) -->
  @if (false) {
    <div class="rounded-lg bg-surface-tertiary p-4">
      <p class="text-xs text-neutral-400">
        Form Valid: {{ productForm.valid }} | Form Touched: {{ productForm.touched }} | Form Dirty:
        {{ productForm.dirty }}
      </p>
    </div>
  }
</form>
